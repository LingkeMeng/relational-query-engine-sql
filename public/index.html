<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard — Stock Social</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<dialog id="dlg-create-portfolio">
  <form method="dialog" aria-label="Create portfolio form">
    <h3>Create Portfolio</h3>

    <label for="portfolio-name">Portfolio Name</label>
    <input id="portfolio-name" name="name" type="text" placeholder="Portfolio name" required />

    <div class="row" style="margin-top:12px">
      <button class="btn primary" type="submit">Create</button>
      <button class="btn" type="button" onclick="document.getElementById('dlg-create-portfolio').close()">Cancel</button>
    </div>
  </form>
</dialog>
<dialog id="dlg-deposit" class="card">
  <form method="dialog" data-action="/api/cash/deposit">
    <h3>Deposit Cash</h3>
    <label>Amount</label><input name="amount" type="number" min="0" required />
    <div class="row" style="margin-top:10px">
      <button class="btn good" value="ok" id="process-deposit" type="submit">Deposit</button>
      <button class="btn" type="button" id="cancel-deposit">Cancel</button>
    </div>
  </form>
</dialog>

<dialog id="dlg-withdraw" class="card">
  <form method="dialog" data-action="/api/cash/withdraw">
    <h3>Withdraw Cash</h3>
    <label>Amount</label><input name="amount" type="number" step="0.01" min="0" required />
    <div class="row" style="margin-top:10px">
      <button class="btn bad" value="ok" type="submit">Withdraw</button>
      <button class="btn" type="button" id="cancel-withdraw">Cancel</button>
    </div>
  </form>
</dialog>
<body>
  <header>
    <div class="bar">
      <div class="logo"><span class="dot" aria-hidden="true"></span> CSCC43 Project <span class="tag">Demo</span></div>
      <nav class="right">
        <a class="btn" href="index.html">Dashboard</a>
        <a class="btn" href="stocks.html">Stocks</a>
        <a class="btn" href="lists.html">Lists</a>
        <a class="btn" href="friends.html">Friends</a>
        <a class="btn" href="portfolios.html">Dev</a>
        <a class="btn" href="auth.html">Sign in / Sign up</a>
      </nav>
    </div>
  </header>

  <main class="container grid grid-3">
    <section class="card">
    <div class="row" style="justify-content:space-between; align-items:center; margin-bottom:6px; display: flex;"></div>
      <h2>Dashboard</h2>
      <button id="btn-create-portfolio" class="btn primary">
        + Create Portfolio
      </button>
      <div class="pill">Cash: <strong id="cash-total">—</strong></div>
    </div>
      <p class="muted">Overview of cash, holdings MV, Beta / covariance, and recent activity.</p>
      <div id="date-range-section">

        <div class="date-row">
          <label class="date-label">Start:</label>
          <input type="date" id="start-date" class="date-input">
          <button id="set-start-btn" type="button" class="date-btn">Set Start</button>
        </div>
      
        <div class="date-row">
          <label class="date-label">End:</label>
          <input type="date" id="end-date" class="date-input">
          <button id="set-end-btn" type="button" class="date-btn">Set End</button>
        </div>
      
      </div>
      <div class="grid grid-1" style="margin-top:8px">
        
        <div class="card">
          <h3>Holdings</h3>
    <table aria-label="Holdings table" id="holdings-table">
      <thead>
        <tr>
          <th>Symbol</th>
          <th>Shares</th>
          <th>Last Close</th>
          <th>AVG</th>
          <th>MV</th>
          <th>COV</th>
          <th>Beta</th>
        </tr>
      </thead>
      <tbody id="holdings-body">
        <tr><td colspan="5" class="muted">No holdings yet</td></tr>
      </tbody>
    </table>
        </div>
      </div>
    </section>

    <aside class="card" aria-labelledby="quick-title">
      <h2 id="quick-title">Quick Actions</h2>
      <div class="row">
        <button class="btn" id="btn-deposit" data-open="#dlg-deposit">Deposit cash</button>
        <button class="btn" id="btn-withdraw" data-open="#dlg-withdraw">Withdraw cash</button>
        <button class="btn" id = "tr-buy" data-open="#dlg-buy">Buy stocks</button>
        <button class="btn" id = "tr-sell" data-open="#dlg-sell">Sell stocks</button>
      </div>
      

      <div class="hr"></div>

      <!-- Recent Activity -->
      <h3>Recent Activity</h3>
    <table aria-label="Recent activity">
      <thead>
        <tr><th>Time</th><th>Symbol</th><th>Detail</th></tr>
      </thead>
      <tbody id="activity-log">
        <tr><td colspan="3" class="muted">No activity yet</td></tr>
      </tbody>
    </table>
    </aside>

    <aside class="card">
      <h2>Portfolio Selection</h2>
      <p class="muted">Select your portfolio here</p>
      <div id="portfolio-list" class="portfolio-list"></div>
    </aside>
  </main>

  <!-----------Buy/sell cards---------->
  <dialog id="dlg-buy" class="card">
    <form method="dialog" data-action="/api/trade/buy">
      <h3>Record Buy</h3>
      <label>Symbol</label><input name="symbol" placeholder="AAPL" required />
      <label>Shares</label><input name="shares" type="number" step="1" min="1" required />
      <label>Price (optional)</label><input name="price" type="number" step="0.0001" min="0" />
      <div class="row" style="margin-top:10px">
        <button class="btn primary" type="submit" value="ok">Save</button>
        <button class="btn" type="button" id="cancel-buy">Cancel</button>
      </div>
    </form>
  </dialog>

  <dialog id="dlg-sell" class="card">
    <form method="dialog" data-action="/api/trade/sell">
      <h3>Record Sell</h3>
      <label>Symbol</label><input name="symbol" placeholder="AAPL" required />
      <label>Shares</label><input name="shares" type="number" step="1" min="1" required />
      <label>Price (optional)</label><input name="price" type="number" step="0.0001" min="0" />
      <div class="row" style="margin-top:10px">
        <button class="btn bad" value="ok" type="submit">Save</button>
        <button class="btn" type="button" id="cancel-sell">Cancel</button>
      </div>
    </form>
  </dialog>
  <!-----------holdings card -------->
  <dialog id="stock-dialog" class="card">
    <div class="dialog-content">
      <h3 id="dialog-title"></h3>
  
      <button id="history-btn" class="dialog-button" type="button">Plot history</button>
      <button id="predict-btn" class="dialog-button" type="button">Plot prediction</button>
  
      <button id="close-dialog" class="dialog-close" type="button">close</button>
    </div>
  </dialog>
  <script type="module" src="js/main.js"></script>
  <script type="module">
    import { initDialogButtons } from "/js/transaction.js";
    initDialogButtons();
  </script>
  <script type="module">
    import { initDateInputs } from "/js/main.js";
    initDateInputs();
  </script>
</body>
</html>
